<!-- Giscus Comments -->
<div class="giscus-container mt-12 pt-8 border-t border-border-color">
    <div class="giscus" 
         data-repo="Developing-Apologist/blog"
        data-repo-id="R_kgDOPHah6A"
        data-category="Blog Comments"
        data-category-id="DIC_kwDOPHah6M4Cs154"
        data-mapping="title"
        data-strict="0"
        data-reactions-enabled="1"
        data-emit-metadata="1"
        data-input-position="top"
        data-theme="dark"
        data-lang="en"
        data-loading="lazy">
    </div>
</div>

<script>
    // Giscus configuration with single category for all blog comments
    const giscusConfig = {
        repo: 'Developing-Apologist/blog',
        repoId: 'R_kgDOPHah6A',
        category: 'Blog Comments',
        categoryId: 'DIC_kwDOPHah6M4Cs154',
        mapping: 'title',
        strict: '0',
        reactionsEnabled: '1',
        emitMetadata: '1',
        inputPosition: 'top',
        theme: 'dark',
        lang: 'en',
        loading: 'lazy'
    };

    // Load Giscus script with error handling and retry logic
    function loadGiscus() {
        // Check if giscus is already loaded
        if (window.giscus) {
            return;
        }

        // Create script element
        const script = document.createElement('script');
        script.src = 'https://giscus.app/client.js';
        script.setAttribute('data-repo', giscusConfig.repo);
        script.setAttribute('data-repo-id', giscusConfig.repoId);
        script.setAttribute('data-category', giscusConfig.category);
        script.setAttribute('data-category-id', giscusConfig.categoryId);
        script.setAttribute('data-mapping', giscusConfig.mapping);
        script.setAttribute('data-strict', giscusConfig.strict);
        script.setAttribute('data-reactions-enabled', giscusConfig.reactionsEnabled);
        script.setAttribute('data-emit-metadata', giscusConfig.emitMetadata);
        script.setAttribute('data-input-position', giscusConfig.inputPosition);
        script.setAttribute('data-theme', giscusConfig.theme);
        script.setAttribute('data-lang', giscusConfig.lang);
        script.setAttribute('data-loading', giscusConfig.loading);
        script.async = true;
        
        // Add error handling
        script.onerror = function() {
            console.warn('Failed to load giscus script, retrying in 2 seconds...');
            setTimeout(loadGiscus, 2000);
        };
        
        // Add load event to ensure giscus is properly initialized
        script.onload = function() {
            // Force giscus to reload if it doesn't appear
            setTimeout(() => {
                if (window.giscus && typeof window.giscus.loadGiscusDiscussion === 'function') {
                    window.giscus.loadGiscusDiscussion();
                }
            }, 1000);
        };
        
        document.head.appendChild(script);
    }

    // Load Giscus when the page is ready
    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', loadGiscus);
    } else {
        loadGiscus();
    }
</script> 